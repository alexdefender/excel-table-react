(this["webpackJsonpexcel-table-react"]=this["webpackJsonpexcel-table-react"]||[]).push([[0],{19:function(e,t,n){e.exports=n(39)},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(6),c=n.n(r),u=n(2),i=(n(30),n(31),function(e){return{type:"SET_CURRENCY_CELL",payload:e}}),o=function(e){var t=e.children;return l.a.createElement("div",{className:"TableWrap"},t)},s=(n(32),n(33),function(){var e,t,n=Object(u.d)((function(e){return e})),a=n.selectedCell,r=n.tableData,c=(null===(e=r[a])||void 0===e?void 0:e.formulaCell)||(null===(t=r[a])||void 0===t?void 0:t.valueCell)||"";return l.a.createElement("div",{className:"InfoRow"},l.a.createElement("input",{type:"text",defaultValue:c,readOnly:!0}))}),d=n(1),p=["\u0433\u0440\u043d.","$","\u0440."],f=(n(34),function(){var e,t,n=Object(u.c)(),r=Object(u.d)((function(e){return e})),c=r.selectedCell,o=r.tableData,s=(null===(e=o[c])||void 0===e?void 0:e.type)||"string",f=(null===(t=o[c])||void 0===t?void 0:t.currency)||"",E=o[c]&&"currency"===o[c].type;if(Object(a.useEffect)((function(){E&&!f&&n(i(Object(d.a)({},c,{currency:p[0]})))}),[E]),""===c)return null;var v=function(e){e.stopPropagation();var t=e.target.value;p.includes(t)?n(i(Object(d.a)({},c,{currency:t}))):(n({type:"SET_TYPE_CELL",payload:Object(d.a)({},c,{type:t})}),n(i(Object(d.a)({},c,{currency:""}))))},C=l.a.createElement("select",{value:f,name:"type-data",onChange:v},p.map((function(e,t){return l.a.createElement("option",{key:"".concat(e,"-").concat(t),value:e},e)})));return l.a.createElement("div",{className:"TypeData"},l.a.createElement("select",{value:s,name:"type-data",onChange:v},l.a.createElement("option",{value:"string"},"String"),l.a.createElement("option",{value:"number"},"Number"),l.a.createElement("option",{value:"currency"},"Currency")),E&&C)}),E=n(11),v=(n(35),{"=SUM(\u2026)":"\u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0443\u043c\u043c\u0443 \u0440\u044f\u0434\u0430 \u0447\u0438\u0441\u0435\u043b \u0438\u043b\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0440\u044f\u0434\u0430 \u044f\u0447\u0435\u0435\u043a. \n    \u041f\u0440\u0438\u043c\u0435\u0440: =SUM(A1;A2;10;20). \u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0442\u0438\u043f\u044b - number \u0438 currency.\n    \u0427\u0438\u0441\u043b\u043e \u043a \u0432\u0430\u043b\u044e\u0442\u0435 \u043f\u0440\u0438\u0431\u0430\u0432\u043b\u044f\u0442\u044c \u043d\u0435\u043b\u044c\u0437\u044f. \u0422\u043e\u043b\u044c\u043a\u043e \u0447\u0438\u0441\u043b\u0430 \u043a \u0447\u0438\u0441\u043b\u0430\u043c \u0438 \u0432\u0430\u043b\u044e\u0442\u0430 \u043a \u0432\u0430\u043b\u044e\u0442\u0435.","=AVERAGE(\u2026)":"\u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u0442 \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u0430\u0440\u0438\u0444\u043c\u0435\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432 (\u0437\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u0445). \n    \u041f\u0440\u0438\u043c\u0435\u0440: =AVERAGE(A1;A2;10;20). \u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0442\u0438\u043f\u044b - number \u0438 currency. \u0423\u0441\u043b\u043e\u0432\u0438\u044f \u0442\u0430\u043a\u0438\u0435 \u0436\u0435, \u043a\u0430\u043a \u0432 =SUM(\u2026).","=CONCAT(\u2026)":"\u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0435\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439. \u041f\u0440\u0438\u043c\u0435\u0440: =CONCAT(A1;A2;10;20).","=HYPERLINK(\u2026)":"c\u043e\u0437\u0434\u0430\u0435\u0442 \u0433\u0438\u043f\u0435\u0440\u0441\u0441\u044b\u043b\u043a\u0443 \u0432 \u044f\u0447\u0435\u0439\u043a\u0435. \u041f\u0440\u0438\u043c\u0435\u0440: =HYPERLINK(https://site.ua)."}),C=function(){var e=Object(a.useState)(!1),t=Object(E.a)(e,2),n=t[0],r=t[1],c=n?l.a.createElement("div",null,Object.entries(v).map((function(e){var t=Object(E.a)(e,2),n=t[0],a=t[1];return l.a.createElement("div",{key:n},l.a.createElement("span",null,n)," - ",l.a.createElement("span",null,a))}))):null;return l.a.createElement("div",{className:"Faq"},l.a.createElement("div",{onClick:function(){r(!n)}},"Faq"),c)},m=function(){return l.a.createElement("div",{className:"TableInfo"},l.a.createElement(f,null),l.a.createElement(s,null),l.a.createElement(C,null))},y=(n(36),function(e){var t=e.children;return l.a.createElement("table",{id:"table"},l.a.createElement("tbody",null,t))}),b=function(e){var t=e.children;return l.a.createElement("tr",null,t)},h=n(14),O=n(15),D=n(18),g=n(16);n(37);function S(e){if("string"===typeof e){return new RegExp("^(https?://)?(www\\.)?([-a-z0-9]{1,63}\\.)*?[a-z0-9][-a-z0-9]{0,61}[a-z0-9]\\.[a-z]{2,6}(/[-\\w@\\+\\.~#\\?&/=%]*)?$","i").test(e)}}var j=n(17),_=n(4),L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SELECTED_CELL":return t.payload;default:return e}},A=n(3),N={},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0,n=null;switch(t.type){case"SET_ALL_TABLE_DATA":return Object(A.a)({},t.payload);case"SET_CELL_DATA":case"SET_TYPE_CELL":case"SET_CURRENCY_CELL":return n=Object.keys(t.payload)[0],Object(A.a)({},e,Object(d.a)({},n,Object(A.a)({},e[n],{},t.payload[n])));default:return e}},k=Object(_.b)({selectedCell:L,tableData:T}),R=Object(_.c)(k,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),w="",x="",I="",U={"=SUM(":function(){for(var e=R.getState(),t=e.tableData,n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];var r=a.map((function(e){return!!V(t[I],t[e])&&(t[e]?t[I].type===t[e].type&&t[e].valueCell:!isNaN(e)&&e)}));return r.includes(!1)?"#ERROR!":r.reduce((function(e,t){return+e+ +t}))},"=AVERAGE(":function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=U["=SUM("].apply(U,t),l=R.getState(),r=l.tableData,c=t.reduce((function(e,t){return""===t||isNaN(t)?void 0!==r[t]&&""!==r[t].valueCell?++e:e:++e}),0),u=(a/c).toFixed(2).toString().replace(/(\.[0-9]*[1-9])0+$|\.0*$/,"$1");return isNaN(u)?"#ERROR!":u},"=CONCAT(":function(){for(var e=R.getState(),t=e.tableData,n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];var r=a.map((function(e){return t[e]?t[e].valueCell:e}));return r.join("")},"=HYPERLINK(":function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length>1)return"#ERROR!";var a=S(t[0].toLowerCase());return a?t[0].toLowerCase():"#ERROR!"}};function V(e,t){var n=["number","currency"],a=e.type,l=null===t||void 0===t?void 0:t.type;return!(!n.includes(a)||!n.includes(l))||!!n.includes(a)}function P(e,t){var n=e.toUpperCase();n.slice(-1);var a=null;if(I=t,function(e){return Object.keys(U).some((function(t){return!!e.includes(t)&&(w=t,x=U[t],!0)}))}(n)){var l=function(e){return e.replace(/ +/g," ").replace(/\)+/g,"").replace(/; +|;+| ; +/g,";").replace(w,"").split(";")}(n);l.length>0&&(a=x.apply(void 0,Object(j.a)(l)))}return")"!==n[n.length-1]&&(n+=")"),{newValueCell:a,formulaCell:n}}var F=function(e){Object(D.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).updateCellData=function(e,t){var n;if(e.includes("=")){var l=P(e,t),r=l.newValueCell,c=l.formulaCell;n=Object(d.a)({},t,{valueCell:r,formulaCell:c})}else n=Object(d.a)({},t,{valueCell:e,formulaCell:""});a.props.setCellData(n)},a.updateFormulasData=function(){var e=a.props.tableData;for(var t in e)e.hasOwnProperty(t)&&""!==e[t].formulaCell&&a.updateCellData(e[t].formulaCell,t)},a.clearCellData=function(){a.props.setCellData(Object(d.a)({},a.props.selectedCell,{valueCell:"",formulaCell:""}))},a.handleKeyDown=function(e){e.stopPropagation();var t=a.props,n=t.indexCell,l=t.selectedCell,r=a.state.isEdit;if(n!==l||r||8!==e.keyCode&&46!==e.keyCode||a.clearCellData(),13===e.keyCode&&null!==a.refInput){var c=a.refInput.value;a.updateCellData(c,l),a.updateFormulasData(),r&&a.setState({isEdit:!1})}},a.handleClick=function(e){e.stopPropagation(),a.props.setSelectedCell(a.props.indexCell)},a.handleDoubleClick=function(e){e.stopPropagation(),a.setState({isEdit:!0})},a.generateValueCell=function(){var e=a.props,t=e.tableData,n=e.indexCell,r=a.state.isEdit,c=t[n],u=c.currency,i=c.formulaCell,o=c.valueCell,s=o;return o&&u&&(s=function(e,t){if(isNaN(e))return"#ERROR!";var n=(e=Number(e).toFixed(2)).toString().split(".");return n[0]=n[0].replace(/\B(?=(\d{3})+(?!\d))/g," "),t+(e=n.join(","))}(o,u)),S(o)&&(s=l.a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},o)),r&&(s=l.a.createElement("input",{autoFocus:!0,defaultValue:i||o,ref:function(e){return a.refInput=e}})),s},a.state={isEdit:!1},a.refInput=null,a}return Object(O.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){var n=this.props,a=n.indexCell,l=n.selectedCell,r=n.tableData,c=this.state.isEdit;return e.indexCell===e.selectedCell||a===l||(c!==t.isEdit||JSON.stringify(r[a])!==JSON.stringify(e.tableData[e.indexCell]))}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(e,t){var n,a,l=this,r=this.props,c=r.indexCell,u=r.selectedCell,i=r.tableData,o=this.state.isEdit;if(e.selectedCell!==u){if(o&&this.setState({isEdit:!1}),null!==this.refInput){var s=this.refInput.value;this.updateCellData(s,c)}setTimeout((function(){l.updateFormulasData()}),0)}(null===(n=e.tableData[c])||void 0===n?void 0:n.type)!==(null===(a=i[c])||void 0===a?void 0:a.type)&&this.updateFormulasData()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){var e=this.props,t=e.selectedCell,n=e.indexCell,a=e.tableData;if(0===Object.keys(a).length)return null;var r=n===t,c=this.generateValueCell(),u=r?"SelectedCell":null;return l.a.createElement("td",{className:u,onClick:this.handleClick,onDoubleClick:this.handleDoubleClick},c)}}]),n}(a.Component),Y=Object(u.b)((function(e){return{selectedCell:e.selectedCell,tableData:e.tableData}}),{setSelectedCell:function(e){return{type:"SET_SELECTED_CELL",payload:e}},setCellData:function(e){return{type:"SET_CELL_DATA",payload:e}}})(F),K=(n(38),function(e){var t=e.value;return l.a.createElement("th",null,t)}),M={},z=function(){var e=Array(11).fill(null),t=" ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").slice(0,11);return l.a.createElement(y,null,e.map((function(e,n){return l.a.createElement(b,{key:"row-".concat(n)},t.map((function(e,t){if(0===n)return 0===t?l.a.createElement(K,{key:"0-".concat(n),value:e}):l.a.createElement(K,{key:"".concat(e,"-").concat(n),value:e});if(0===t)return l.a.createElement(K,{key:"".concat(t,"-").concat(n),value:n.toString()});var a="".concat(e).concat(n);return function(e){M[e]={valueCell:"",formulaCell:"",type:"string",currency:""}}(a),l.a.createElement(Y,Object.assign({key:"".concat(e,"-").concat(t)},{indexCell:a}))})))})))},B=function(){var e=Object(u.c)(),t=z();return Object(a.useEffect)((function(){e({type:"SET_ALL_TABLE_DATA",payload:M})}),[]),l.a.createElement("div",{className:"Container"},l.a.createElement(m,null),l.a.createElement(o,null,t))};c.a.render(l.a.createElement(u.a,{store:R},l.a.createElement(B,null)),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.6c3a2bad.chunk.js.map