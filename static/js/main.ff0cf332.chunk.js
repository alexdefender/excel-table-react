(this["webpackJsonpexcel-table-react"]=this["webpackJsonpexcel-table-react"]||[]).push([[0],{19:function(e,t,a){e.exports=a(39)},30:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(6),c=a.n(r),u=a(2),i=(a(30),a(31),function(e){return{type:"SET_CURRENCY_CELL",payload:e}}),o=function(e){var t=e.children;return l.a.createElement("div",{className:"TableWrap"},t)},s=(a(32),a(33),function(){var e,t,a=Object(u.d)((function(e){return e})),n=a.selectedCell,r=a.tableData,c=(null===(e=r[n])||void 0===e?void 0:e.formulaCell)||(null===(t=r[n])||void 0===t?void 0:t.valueCell)||"";return l.a.createElement("div",{className:"InfoRow"},l.a.createElement("input",{type:"text",defaultValue:c,readOnly:!0}))}),d=a(1),p=["\u0433\u0440\u043d.","$","\u0440."],f=(a(34),function(){var e,t,a=Object(u.c)(),r=Object(u.d)((function(e){return e})),c=r.selectedCell,o=r.tableData,s=(null===(e=o[c])||void 0===e?void 0:e.type)||"string",f=(null===(t=o[c])||void 0===t?void 0:t.currency)||"",E=o[c]&&"currency"===o[c].type;if(Object(n.useEffect)((function(){E&&!f&&a(i(Object(d.a)({},c,{currency:p[0]})))}),[E]),""===c)return null;var v=function(e){e.stopPropagation();var t=e.target.value;p.includes(t)?a(i(Object(d.a)({},c,{currency:t}))):(a({type:"SET_TYPE_CELL",payload:Object(d.a)({},c,{type:t})}),a(i(Object(d.a)({},c,{currency:""}))))},C=l.a.createElement("select",{value:f,name:"type-data",onChange:v},p.map((function(e,t){return l.a.createElement("option",{key:"".concat(e,"-").concat(t),value:e},e)})));return l.a.createElement("div",{className:"TypeData"},l.a.createElement("select",{value:s,name:"type-data",onChange:v},l.a.createElement("option",{value:"string"},"String"),l.a.createElement("option",{value:"number"},"Number"),l.a.createElement("option",{value:"currency"},"Currency")),E&&C)}),E=a(11),v=(a(35),{"=SUM(\u2026)":"\u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u0441\u0443\u043c\u043c\u0443 \u0440\u044f\u0434\u0430 \u0447\u0438\u0441\u0435\u043b \u0438\u043b\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e \u0440\u044f\u0434\u0430 \u044f\u0447\u0435\u0435\u043a. \u041f\u0440\u0438\u043c\u0435\u0440: =SUM(A1;A2;10;20). \u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0442\u0438\u043f\u044b - number \u0438 currency.","=AVERAGE(\u2026)":"\u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u0442 \u0441\u0440\u0435\u0434\u043d\u0435\u0435 \u0430\u0440\u0438\u0444\u043c\u0435\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0430\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u043e\u0432 (\u0437\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u044b\u0445). \u041f\u0440\u0438\u043c\u0435\u0440: =AVERAGE(A1;A2;10;20). \u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0442\u0438\u043f\u044b - number \u0438 currency.","=CONCAT(\u2026)":"\u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0435\u0442 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439. \u041f\u0440\u0438\u043c\u0435\u0440: =CONCAT(A1;A2;10;20).","=HYPERLINK(\u2026)":"c\u043e\u0437\u0434\u0430\u0435\u0442 \u0433\u0438\u043f\u0435\u0440\u0441\u0441\u044b\u043b\u043a\u0443 \u0432 \u044f\u0447\u0435\u0439\u043a\u0435. \u041f\u0440\u0438\u043c\u0435\u0440: =HYPERLINK(https://site.ua)."}),C=function(){var e=Object(n.useState)(!1),t=Object(E.a)(e,2),a=t[0],r=t[1],c=a?l.a.createElement("div",null,Object.entries(v).map((function(e){var t=Object(E.a)(e,2),a=t[0],n=t[1];return l.a.createElement("div",{key:a},l.a.createElement("span",null,a)," - ",l.a.createElement("span",null,n))}))):null;return l.a.createElement("div",{className:"Faq"},l.a.createElement("div",{onClick:function(){r(!a)}},"Faq"),c)},m=function(){return l.a.createElement("div",{className:"TableInfo"},l.a.createElement(f,null),l.a.createElement(s,null),l.a.createElement(C,null))},y=(a(36),function(e){var t=e.children;return l.a.createElement("table",{id:"table"},l.a.createElement("tbody",null,t))}),b=function(e){var t=e.children;return l.a.createElement("tr",null,t)},h=a(14),O=a(15),D=a(18),g=a(16);a(37);function S(e){if("string"===typeof e){return new RegExp("^(https?://)?(www\\.)?([-a-z0-9]{1,63}\\.)*?[a-z0-9][-a-z0-9]{0,61}[a-z0-9]\\.[a-z]{2,6}(/[-\\w@\\+\\.~#\\?&/=%]*)?$","i").test(e)}}var j=a(17),_=a(4),L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SELECTED_CELL":return t.payload;default:return e}},A=a(3),N={},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0,a=null;switch(t.type){case"SET_ALL_TABLE_DATA":return Object(A.a)({},t.payload);case"SET_CELL_DATA":case"SET_TYPE_CELL":case"SET_CURRENCY_CELL":return a=Object.keys(t.payload)[0],Object(A.a)({},e,Object(d.a)({},a,Object(A.a)({},e[a],{},t.payload[a])));default:return e}},k=Object(_.b)({selectedCell:L,tableData:T}),R=Object(_.c)(k,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),w="",x="",I="",U={"=SUM(":function(){for(var e=R.getState(),t=e.tableData,a=arguments.length,n=new Array(a),l=0;l<a;l++)n[l]=arguments[l];var r=n.map((function(e){return!!V(t[I],t[e])&&(t[e]?t[I].type===t[e].type&&t[e].valueCell:!isNaN(e)&&e)}));return r.includes(!1)?"#ERROR!":r.reduce((function(e,t){return+e+ +t}))},"=AVERAGE(":function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=U["=SUM("].apply(U,t),l=R.getState(),r=l.tableData,c=t.reduce((function(e,t){return""===t||isNaN(t)?void 0!==r[t]&&""!==r[t].valueCell?++e:e:++e}),0),u=(n/c).toFixed(2).toString().replace(/(\.[0-9]*[1-9])0+$|\.0*$/,"$1");return isNaN(u)?"#ERROR!":u},"=CONCAT(":function(){for(var e=R.getState(),t=e.tableData,a=arguments.length,n=new Array(a),l=0;l<a;l++)n[l]=arguments[l];var r=n.map((function(e){return t[e]?t[e].valueCell:e}));return r.join("")},"=HYPERLINK(":function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];if(t.length>1)return"#ERROR!";var n=S(t[0].toLowerCase());return n?t[0].toLowerCase():"#ERROR!"}};function V(e,t){var a=["number","currency"],n=e.type,l=null===t||void 0===t?void 0:t.type;return!(!a.includes(n)||!a.includes(l))||!!a.includes(n)}function P(e,t){var a=e.toUpperCase();a.slice(-1);var n=null;if(I=t,function(e){return Object.keys(U).some((function(t){return!!e.includes(t)&&(w=t,x=U[t],!0)}))}(a)){var l=function(e){return e.replace(/ +/g," ").replace(/\)+/g,"").replace(/; +|;+| ; +/g,";").replace(w,"").split(";")}(a);l.length>0&&(n=x.apply(void 0,Object(j.a)(l)))}return")"!==a[a.length-1]&&(a+=")"),{newValueCell:n,formulaCell:a}}var F=function(e){Object(D.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).updateCellData=function(e,t){var a;if(e.includes("=")){var l=P(e,t),r=l.newValueCell,c=l.formulaCell;a=Object(d.a)({},t,{valueCell:r,formulaCell:c})}else a=Object(d.a)({},t,{valueCell:e,formulaCell:""});n.props.setCellData(a)},n.updateFormulasData=function(){var e=n.props.tableData;for(var t in e)e.hasOwnProperty(t)&&""!==e[t].formulaCell&&n.updateCellData(e[t].formulaCell,t)},n.clearCellData=function(){n.props.setCellData(Object(d.a)({},n.props.selectedCell,{valueCell:"",formulaCell:""}))},n.handleKeyDown=function(e){e.stopPropagation();var t=n.props,a=t.indexCell,l=t.selectedCell,r=n.state.isEdit;if(a!==l||r||8!==e.keyCode&&46!==e.keyCode||n.clearCellData(),13===e.keyCode&&null!==n.refInput){var c=n.refInput.value;n.updateCellData(c,l),n.updateFormulasData(),r&&n.setState({isEdit:!1})}},n.handleClick=function(e){e.stopPropagation(),n.props.setSelectedCell(n.props.indexCell)},n.handleDoubleClick=function(e){e.stopPropagation(),n.setState({isEdit:!0})},n.generateValueCell=function(){var e=n.props,t=e.tableData,a=e.indexCell,r=n.state.isEdit,c=t[a],u=c.currency,i=c.formulaCell,o=c.valueCell,s=o;return o&&u&&(s=function(e,t){if(isNaN(e))return"#ERROR!";var a=(e=Number(e).toFixed(2)).toString().split(".");return a[0]=a[0].replace(/\B(?=(\d{3})+(?!\d))/g," "),t+(e=a.join(","))}(o,u)),S(o)&&(s=l.a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},o)),r&&(s=l.a.createElement("input",{autoFocus:!0,defaultValue:i||o,ref:function(e){return n.refInput=e}})),s},n.state={isEdit:!1},n.refInput=null,n}return Object(O.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props,n=a.indexCell,l=a.selectedCell,r=a.tableData,c=this.state.isEdit;return e.indexCell===e.selectedCell||n===l||(c!==t.isEdit||JSON.stringify(r[n])!==JSON.stringify(e.tableData[e.indexCell]))}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(e,t){var a,n,l=this.props,r=l.indexCell,c=l.selectedCell,u=l.tableData,i=this.state.isEdit;if(e.selectedCell!==c){if(i&&this.setState({isEdit:!1}),null!==this.refInput){var o=this.refInput.value;this.updateCellData(o,r)}this.updateFormulasData()}(null===(a=e.tableData[r])||void 0===a?void 0:a.type)!==(null===(n=u[r])||void 0===n?void 0:n.type)&&this.updateFormulasData()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){var e=this.props,t=e.selectedCell,a=e.indexCell,n=e.tableData;if(0===Object.keys(n).length)return null;var r=a===t,c=this.generateValueCell(),u=r?"SelectedCell":null;return l.a.createElement("td",{className:u,onClick:this.handleClick,onDoubleClick:this.handleDoubleClick},c)}}]),a}(n.Component),Y=Object(u.b)((function(e){return{selectedCell:e.selectedCell,tableData:e.tableData}}),{setSelectedCell:function(e){return{type:"SET_SELECTED_CELL",payload:e}},setCellData:function(e){return{type:"SET_CELL_DATA",payload:e}}})(F),K=(a(38),function(e){var t=e.value;return l.a.createElement("th",null,t)}),M={},z=function(){var e=Array(11).fill(null),t=" ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").slice(0,11);return l.a.createElement(y,null,e.map((function(e,a){return l.a.createElement(b,{key:"row-".concat(a)},t.map((function(e,t){if(0===a)return 0===t?l.a.createElement(K,{key:"0-".concat(a),value:e}):l.a.createElement(K,{key:"".concat(e,"-").concat(a),value:e});if(0===t)return l.a.createElement(K,{key:"".concat(t,"-").concat(a),value:a.toString()});var n="".concat(e).concat(a);return function(e){M[e]={valueCell:"",formulaCell:"",type:"string",currency:""}}(n),l.a.createElement(Y,Object.assign({key:"".concat(e,"-").concat(t)},{indexCell:n}))})))})))},B=function(){var e=Object(u.c)(),t=z();return Object(n.useEffect)((function(){e({type:"SET_ALL_TABLE_DATA",payload:M})}),[]),l.a.createElement("div",{className:"Container"},l.a.createElement(m,null),l.a.createElement(o,null,t))};c.a.render(l.a.createElement(u.a,{store:R},l.a.createElement(B,null)),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.ff0cf332.chunk.js.map